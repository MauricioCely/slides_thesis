---
title: |
  Coherent Structures Detection within a Dense Alpine Forest.
subtitle: ""
author: 
  - "Presented by:" 
  - "&nbsp;&nbsp; [IvÃ¡n Mauricio Cely Toro](mailto:mauriciocelytoro@hotmail.com) <br/>"
institute:   
  - "Advised by: <br/>"
  - "&nbsp;&nbsp; [Luca Mortarini](mailto:l.mortarini@gmail.com), PhD. - **CNR** ðŸ‡®ðŸ‡¹<br/>&nbsp;&nbsp; GervÃ¡sio Annes Degrazia, PhD. - **UFSM** ðŸ‡§ðŸ‡·"
date: "Santa Maria - &copy; - `r lubridate::year(Sys.Date())`"
format:
  revealjs: 
    multiplex: true
    slide-number: false
    menu: false
    preview-link: true
    scrollable: false
    navigation-mode: linear
    incremental: true
    controls-layout: edges
    pdf-separate-fragments: true
    toc: true
    toc-title: |
      <lord-icon src="https://cdn.lordicon.com/ttioogfl.json" trigger="morph" style="width:100px;height:100px"> </lord-icon> Contents
    toc-depth: 2
    controls-tutorial: true
    reference-location: document
    theme: [simple, css/mytheme.scss]
    smaller: false
    auto-stretch: true
    chalkboard: 
      buttons: false
      # src: drawings.json 
      # transition: 150
    # template: template/slides_template.html
    preview-links: auto
    logo: misc/logo3.png
    css: css/styles.css
    fig-cap-location: bottom
    footer: |
      [Universidade Federal de Santa Maria](https://www.ufsm.br) - Programa de PÃ³s-GraduaÃ§Ã£o em FÃ­sica
header-includes: |
  <script src="https://cdn.lordicon.com/xdjxvujz.js"></script>
title-slide-attributes:
    data-background-video: misc/Intro_Forest.mp4
    data-background-size: cover
    data-background-opacity: "0.9"
    data-background-video-loop: true
    data-background-video-muted: true
    footer: false
filters:
  - roughnotation
bibliography: bib/references.bib
---

```{r, setup, include=FALSE}
library(rgl) # 3D Visualization Using OpenGL, [github::dmurdoch/rgl] v0.110.2

knitr::knit_hooks$set(webgl = hook_webgl)

knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, cache = FALSE)

# options(rgl.printRglwidget = TRUE)
library(tidyverse) # Easily Install and Load the 'Tidyverse', CRAN v1.3.2
library(here) # A Simpler Way to Find Your Files, CRAN v1.0.1

```

# Objectives

##  {.unlisted .smaller}

. . .

::: {.callout-tip collapse="false" appearance="default" icon="true"}
## WHAT?

-   To investigate the impact of CS on the RSL flow dynamics and on the exchange processes at the canopy-atmosphere interface in different conditions of atmospheric stratification.
-   To detect and analyse the presence of coherent structures and their characteristic timescales inside a coniferous forest on an Alpine Plateau dataset, to estimate the contribution of CS to turbulent transport of momentum and heat fluxes.
:::

. . .

::: {.callout-note collapse="false" appearance="default" icon="true"}
## HOW?

-   Applying a methodology based on fitting the vertical velocity auto-correlation functions with a theoretical oscillating function previously used by @mortarini2022.
-   Comparing average spectra and cospectra to discriminate between different kind of flow structures in the RSL.
-   Presenting a simplified Lagrangian stochastic model to explain the oscillation of the auto and cross-correlation functions of the wind velocity components in presence of coherent structures.
:::

. . .

::: {.callout-important collapse="false" appearance="default" icon="true"}
## WHY?

-   Canopy turbulence is of crucial importance for its role in a plethora of physical, chemical and biological processes.
-   Represent improvements in the field modelling of Weather or Climate forecast models and in many human activities such as agriculture.
:::

# Problem Background

## Brief summary on Turbulence {.smaller}

> Turbulence in the atmosphere may be generated by wind shear from interaction with the Earth surface or be generated and suppressed by buoyancy effects.

::: columns
::: {.column width="50%" style="text-align: center;"}
```{r out.width = "400px", fig.cap = ("Free Convection ($z_{i}/L = -\\infty$)")}
knitr::include_graphics("images/Free_Convection.gif")
```

Buoyant Turbulence <!-- $\frac{T_{v}}{\theta_{v}} \frac{d \theta}{dz} = \left(\frac{dT_{v}}{dz} + \gamma_a\right) = \gamma_a - \gamma$ -->
:::

::: {.column width="50%" style="text-align: center;"}
```{r out.width = "400px", fig.cap = "Near Neutral ($z_{i}/L =-1$)"}
knitr::include_graphics("images/Near_Neutral.gif")
```

Shear Turbulence <!-- $-\overline{\rho} \langle u'w'\rangle= K_{m} \frac{d \langle U \rangle}{dz}$ -->
:::
:::

## Shear Turbulence {.smaller}

::: {style="text-align: center;"}
```{r out.width = "700px"}
knitr::include_graphics("images/shear_turbulence.png")
```
:::

::: {style="text-align:justify; font-size: 0.8em;"}
The delay introduced by viscosity in the flow allows small perturbation to grow and turbulence to develop
:::

::: {style="text-align: center;"}
```{r out.width = "700px"}
knitr::include_graphics("images/shear_turbulence_2.png")
```
:::

## Buoyant Turbulence {.smaller}

::: {style="text-align:justify;"}
A fluid element perturbed vertically in an unstable flow, keeps accelerating. In a stable flow, its motion is damped.
:::

::: {style="text-align: center;"}
```{r out.width = "500px"}
knitr::include_graphics("images/buoyant_turbulence.png")
```
:::

## TKE and the turbulence spectrum {background-video="misc/Energy_cascade_1.mp4" background-video-loop="true" background="black"}

::: r-stack
![](images/Energy_cascade.png){.fragment fig-align="center" width="900"}
:::

## Boundary Layer {.smaller .unlisted}

::: {style="text-align:justify; font-size: 0.8em;"}
Boundary layer is the thin layer of fluid in the immediate vicinity of a bounding surface formed by the fluid flowing along the surface.
:::

::: {style="text-align: center;"}
```{r out.width = "600px"}
knitr::include_graphics("images/Boundary-layer.png")
```
:::

## ABL {.smaller}

::: columns
::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
> *The boundary layer is the part of the troposphere that is directly influenced by the presence of the Earth's surface, and responds to surface forcings with a timescale of about an hour or less.*
>
> --- @stull1988
:::
:::

::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
```{r out.width = "350px", fig.cap = ("Image taken from @stull2015" )}
knitr::include_graphics("images/ABL.png")
```
:::
:::
:::

::: columns
::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
```{r out.width = "350px", fig.cap = ("Image taken from @grachev2022" )}
knitr::include_graphics("images/ABL_composition.png")
```
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
The bottom 20 to 200 m of the ABL is called the surface layer. There frictional drag, heat conduction, and evaporation from the surface cause substantial variations of wind speed, temperature, and humidity with height.
:::
:::
:::

::: {style="text-align:justify; font-size: 0.7em;"}
The biosphere-atmosphere interaction is a complex system of interconnected physical and chemical phenomena that favor a Goldilocks position for the flourishing of different carbon-based life forms.
:::

## MOST {.smaller}

::: {style="text-align:justify; font-size: 0.8em;"}
Monin--Obukhov similarity theory (MOST) is a zero-order turbulence closure that provides the relationships between the vertical distribution (vertical gradients) of wind and scalars and the corresponding fluxes in a given stability condition.
:::

::: columns
::: {.column width="60%"}
::: {style="text-align: center;"}
```{r out.width = "600px"}
knitr::include_graphics("images/MOST.png")
```
:::
:::

::: {.column width="40%"}
::: {style="text-align: center;"}
```{r out.width = "300px"}
knitr::include_graphics("images/BL_log_law.png")
```

$U_{z} = \frac{u_{\star}}{k} \ln \left( \frac{(z- d_h)}{z_0} \right)$
:::
:::
:::

::: {style="text-align:justify; font-size: 0.7em;"}
> For a number of boundary layer situations, our knowledge of the governing physics is insufficient to derive laws based on first principles. Nevertheless, boundary layer observations frequently show consistent and repeatable characteristics, suggesting that we could develop empirical relationships for the variables of interest. [@stull1988]
:::

## RSL {.smaller}

::: {style="text-align:justify; font-size: 0.8em;"}
The portion of the atmosphere dynamically influenced by the canopy structure, typically extending up to 2--3 times the mean canopy height, $h$.
:::

::: columns
::: {.column width="32%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
```{r out.height = "300px"}
knitr::include_graphics("images/ISL_RSL.png")
```
:::
:::

::: {.column width="32%"}
::: {style="text-align:justify; font-size: 0.8em;"}
```{r out.height= "300px"}
knitr::include_graphics("images/wind_profile.png")
```
:::
:::
:::

::: {style="text-align:center; font-size: 0.8em;"}
$U_{z} = \frac{u_{\star}}{k} \ln \left( \frac{(z- d_h)}{z_0} \right) \rightarrow \text{MOST} \\$

$U_{z} = U(h_{c}) e^{\frac{\beta (z- h_c)}{l_m} } \rightarrow \text{Drag} \\$
:::

##  {.smaller .unlisted}

::: columns
::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
Applying eddy-diffusivity hypothesis inside canopy implies the assumption that the length scale for transport is smaller than, or at least similar to, the length scale of the within- canopy concentration gradient.

```{r out.height = "300px"}
knitr::include_graphics("images/break-eddy.png")
```
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
Inside the canopy sensible heat and $CO_2$ fluxes have the same sign of the scalar gradient, showing a counter-gradient transport.

```{r out.height= "300px"}
knitr::include_graphics("images/counter-gradient.png")
```
:::
:::
:::

## Coherent Structures {.smaller}

::: {style="text-align:justify; font-size: 0.8em;"}
> Coherent Structures are three-dimensional, well-organized flow patterns with characteristic forms and timescales in which fundamental flow variables (such as wind velocity or temperature) exhibit significant correlation with themselves and with each other in a range of space and time that are significantly larger than the high-frequency turbulent scales. [@serafimovich2011; @robinson1991]
:::

::: {style="text-align:center; font-size: 0.8em;"}
```{r out.width= "600px"}
knitr::include_graphics("images/shape_cs.png")
```
:::

## Coherent Structures {.smaller .unlisted}

::: {style="text-align:justify; font-size: 0.8em;"}
Ramps in scalar time series allow to see how distinct ejection/sweep cycles can act on a scalar gradient to produce 'micro-fronts' and highlighted their important role in the exchange processes between forest and atmosphere.
:::

::: r-stack
::: columns
::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
![](images/organised_CS.png){.fragment fragment-index="1" width="400"}
:::
:::

::: {.column width="50%"}
::: {style="text-align:center; font-size: 1.3em;"}
![](images/organised_CS_2.png){.fragment fragment-index="1" width="400"}
:::
:::
:::

![](images/CS.gif){.fragment fragment-index="2" width="700"}
:::

## Coherent Structures {.smaller .unlisted}

::: {style="text-align:justify; font-size: 0.8em;"}
Quadrant analysis allows the quantification of flux contributions from coherent structures, but it is unable to characterize such structures in term of spatial scale and temporal evolution.
:::

::: columns
::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
```{r out.height= "400px", out.width="600px"}
knitr::include_graphics("images/quadrant_1.png")
```
:::
:::

::: {.column width="50%"}
::: {style="text-align:center; font-size: 1.3em;"}
```{r out.height= "400px"}
knitr::include_graphics("images/quadrant_2.png")
```
:::
:::
:::

::: {style="text-align:justify; font-size: 0.8em;"}
Flux contributions from coherent structures in the RSL may range from 40% to 90% of the total fluxes
:::

# Article

## Experimental Site {.smaller}

::: {style="text-align:justify; font-size: 0.8em;"}
The experimental site, part of a long--term CO2 flux monitoring program known as CarboEuro flux, is an uneven--aged mixed coniferous forest located on an Alpine plateau, Lavarone, Italy (45.96â—¦ N, 11.28â—¦ E; 1,300m asl). The forest is primarily composed of Abies alba (70%), Fagus sylvatica (15%), and Picea abies (15%). It is about 28m tall (= h) and the tree crown extends up to 10-12m above the forest floor.
:::

::: columns
::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
```{r out.width = "300px"}
knitr::include_graphics("images/lavarone_location.png")
```
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
```{r out.width = "350px", fig.cap = ("Adapted from @marcolla2003" )}
knitr::include_graphics("images/forest_site.png")
```
:::
:::
:::

##  {.unlisted .smaller}

::: {style="text-align:justify; font-size: 0.8em;"}
The micrometeorological tower was placed on a gently rolling plateau and was surrounded by homogeneous vegetation for radial distances exceeding 1km. It was equipped with five sonic anemometers situated at 33, 25, 17.5, 11 and 4m from the forest floor.
:::

```{r map-3D, file='misc/scripts/map-3D.R', eval=TRUE}
#| webgl: TRUE
#| fig.align: ='center'
#| fig.height: 5.2
#| fig.width: 10
#| rgl.margin: 0

```

## Detection of CS {.smaller}

::: {style="text-align:justify; font-size: 0.8em;"}
@raupach1996 linked the vertical scale of coherent structures ($L_s$ , the 'canopy-shear length scale') to the vorticity thickness related to the inflection point height of the wind velocity profile near the canopy top.
:::

::: columns
::: {.column width="40%"}
::: {style="text-align:center; font-size: 0.8em;"}
$\frac{L_s(x)}{h} = \frac{L_s}{h}\big|_{x=0} - 0.15 \frac{\lvert x \rvert}{x} \sqrt{\frac{x^2}{x^2 + 2/5}}$

where $x= \frac{h}{L}$ e $\frac{L_s}{h}\big|_{x=0} = 0.65$
:::
:::

::: {.column width="60%"}
```{r out.width="450px"}
knitr::include_graphics("images/shear-length.png")
```
:::
:::

::: {style="text-align:justify; font-size: 0.8em;"}
@mortarini2022 presents a parameterization for the behaviour of $L_s$ with stability. Ls increases with decreasing stability, presenting two asymptotes for large unstable and stable stratification and a linear behaviour close to neutral stratification.
:::

## Detection of CS {.unlisted .smaller auto-animate="true"}

::: {style="text-align:justify; font-size: 0.8em;"}
The periodic behaviour of coherent structures above and below the canopy reflects itself in oscillatory autocorrelation functions. @mortarini2022 identified the characteristic time scales of coherent structures fitting 5 minutes Eulerian autocorrelation functions with a dumped oscillating function.
:::

::: columns
::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$R_{\chi}(\tau) = e^{-p_{\chi} \tau}cos(q_{\chi} \tau)$
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$C_{uw}(\tau) = e^{-p_{uw}\tau}\left(\frac{\overline{u'w'}}{\sigma_u \sigma_w}cos(q_{uw} \tau)+\frac{c}{q}sin(q_{uw} \tau)\right)$
:::
:::
:::

## Detection of CS {.unlisted .smaller auto-animate="true"}

::: {style="text-align:justify; font-size: 0.8em;"}
The periodic behaviour of coherent structures above and below the canopy reflects itself in oscillatory autocorrelation functions. @mortarini2022 identified the characteristic time scales of coherent structures fitting 5 minutes Eulerian autocorrelation functions with a dumped oscillating function.
:::

::: columns
::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$\color{red}{p}\quad\\$ Inverse decorrelation (Decaying)

$R_{\chi}(\tau) = e^{-\color{red}{p}_{\chi} \tau}cos(\color{red}{q}_{\chi} \tau)\\$

$F_{\chi\chi}(f) = \frac{E_{\chi\chi}(f)}{\sigma^2_{\chi}} = \int_0^\infty R_{\chi\chi} (\tau) cos(2\pi f \tau)d\tau\\$

$F_{\chi\chi}(f) =2p_{\chi} \left( \frac{1}{p^2_{\chi} + \left( q_{\chi} + 2\pi f\right)^2} +\frac{1}{p^2_{\chi} + \left( q_{\chi} - 2\pi f\right)^2} \right)\\$
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$\color{red}{q}\quad\\$ Frequency of oscillations

$C_{uw}(\tau) = e^{-\color{red}{p}_{uw}\tau}\left(\frac{\overline{u'w'}}{\sigma_u \sigma_w}cos(\color{red}{q}_{uw} \tau)+\frac{c}{\color{red}{q}}sin(\color{red}{q}_{uw} \tau)\right)\\$

$CoF_{uw}(f) = \frac{CoS_{uw}(f)}{\overline{u'w'}} = \int_0^\infty \left[ e^{-p_{uw}~\tau} ~ cos(q_{uw} \tau)\right] cos\left(2 \pi f \tau\right)\\$

$CoF_{uw}(f) = 2p_{uw} \left( \frac{1}{p^2_{uw} + \left( q_{uw} + 2\pi f\right)^2} +\frac{1}{p^2_{uw} + \left( q_{uw} - 2\pi f\right)^2} \right)\\$
:::
:::
:::

## Detection of CS {.unlisted .smaller auto-animate="true"}

::: columns
::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$F_{\chi\chi}(f) =2p_{\chi} \left( \frac{1}{p^2_{\chi} + \left( q_{\chi} + 2\pi f\right)^2} +\frac{1}{p^2_{\chi} + \left( q_{\chi} - 2\pi f\right)^2} \right)\\$
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$CoF_{uw}(f) = 2p_{uw} \left( \frac{1}{p^2_{uw} + \left( q_{uw} + 2\pi f\right)^2} +\frac{1}{p^2_{uw} + \left( q_{uw} - 2\pi f\right)^2} \right)\\$
:::
:::
:::

::: {style="text-align:justify; font-size: 0.8em;"}
Above equations cannot represent an Eulerian spectrum and cospectrum since they do not present a $âˆ’5/3$ slope at high frequency. However, they provide an analytical expression for the frequency, $f_{peak}$ , associated to their maximum value. $T_{peak}$ = $f_{peak}^{-1}$ represents the characteristic time scale associated with the coherent structures
:::

::: {style="text-align:center; font-size: 1em;"}
$f^{(\Psi)}_{peak} = \frac{1}{2\pi}\sqrt{2\sqrt{q^2_{\Psi}\left(p^2_{\Psi}+q^2_{\Psi}\right)}-p^2_{\Psi}-q^2_{\Psi}}\\$
:::

::: {style="text-align:justify; font-size: 0.8em;"}
This equation implies that $\color{red}{m = \frac{q}{p} > \frac{1}{\sqrt{3}} }$ for $F_{\chi\chi}(f)$ and $CoF_{uw}(f)$ have a maximum.
:::

##  {.unlisted}

```{css, echo=FALSE}
.my_class {
height: 500px;
width: 900px;
}

```

```{r, file='misc/scripts/figure_2.R'}
#| class-source: my_class
#| classes: my_class
```

##  {.unlisted}

::: columns
::: {.column width="50%"}
$m > 1$

```{r out.height= "500px"}
knitr::include_graphics("images/Figure_3.png")
```
:::

::: {.column width="50%"}
$m = \text{NA}$

```{r out.height= "500px"}
knitr::include_graphics("images/Figure_3A.png")
```
:::
:::

## Definition Stratification classes {.unlisted .smaller}

::: {style="text-align:center; font-size: 0.8em;"}
```{r out.height= "550px"}
knitr::include_graphics("images/Figure_4.png")
```
:::

##  {.unlisted .smaller}

::: {style="text-align:justify; font-size: 0.8em;"}
@cava2022 use multiresolution and quadrant analyses to investigate the characteristics and the evolution of various flow structures (coherent structures, thermal plumes, submeso motions) that have different origins, length scales and energies in a tall Forest.
:::

::: {style="text-align:center; font-size: 0.8em;"}
```{r out.width="450px"}
knitr::include_graphics("images/multi-spectra.png")
```
:::

::: {style="text-align:justify; font-size: 0.8em;"}
In the RSL all spectra exhibit a peak of energy associated to the mixing-layer type coherent structures characterized by a temporal scale of about 60s (f â‰ˆ 0.016 Hz) that slightly reduces when stability departs from neutrality.
:::

## Methodology

-   A 5 minute subset (u or w) is linearly detrend.
-   Its ACF is evaluated.
-   The ACF is fitted against $R_{\chi}(\tau) = e^{-p_{\chi} \tau}cos(q_{\chi} \tau)$
-   If the fitting procedure returns the parameters p and q and if $m > 1$, $T_{peak}$ is evaluated (Coherent structure).
-   Else, if the fitting procedure does not return values, the 5 min subset is classified as fine turbulence $m = NA$.

## PDF time-scales {.unlisted}

::: {style="text-align:justify; font-size: 0.8em;"}
```{r out.height= "450px"}
knitr::include_graphics("images/Figure_5.png")
```
:::

::: {style="text-align:center; font-size: 0.6em;"}
$T^{(\Psi)}_{peak} = \left[\frac{1}{2\pi}\sqrt{2\sqrt{q^2_{\Psi}\left(p^2_{\Psi}+q^2_{\Psi}\right)}-p^2_{\Psi}-q^2_{\Psi}} \right] ^{-1}$
:::

## Averaged spectra {.unlisted}

::: {style="text-align:justify; font-size: 0.8em;"}
```{r out.height= "550px"}
knitr::include_graphics("images/Figure_6.png")
```
:::

## Averaged cospectra {.unlisted}

::: {style="text-align:justify; font-size: 0.8em;"}
```{r out.height= "550px"}
knitr::include_graphics("images/Figure_7.png")
```
:::

## Results {.unlisted}

::: columns
::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
```{r out.height= "550px"}
knitr::include_graphics("images/Figure_8.png")
```
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
```{r out.height= "550px"}
knitr::include_graphics("images/Figure_9.png")
```
:::
:::
:::

## CS contribution to turbulent exchange {.unlisted}

::: columns
::: {.column width="60%"}
::: {style="text-align:justify; font-size: 0.5em;"}
The net time cover ($TC$) of detected structures represents here the percentage of active coherent structures 5 min subsets in the overall data set: $$
TC = \frac{N_{coh}}{N_{tot}} (\%)
$$ The contribution of coherent structures to the turbulent flux ($FC$) and their transport efficiency ($TE$) are, respectively, defined as: $$
FC = \biggl( \frac{1}{N_{coh}}\sum_{k=1}^{N_{coh}} F_k \biggr)/\biggl( \frac{1}{N}\sum_{i=1}^{N} F_i \biggr) (\%) 
$$ where $F_i$ is the mean turbulent flux in the i-th 5 minute time series. $TE$ values greater (lower) than 1 indicate efficiency (inefficiency) of coherent structures in the turbulent transport.

$$
TE =  \frac{FC}{TC}
$$
:::
:::

::: {.column width="40%"}
::: {style="text-align:center;"}
```{r out.height= "400px", out.width= "650px"}
knitr::include_graphics("images/Figure_10.png")
```
:::
:::
:::

## Lagrangian Stochastic model {.smaller auto-animate="true"}

This very simple turbulence model shows that the oscillations in the correlation functions are generated by the vorticity vector.

::: {.fragment}

::: {style="text-align:justify; font-size: 0.8em;"}
**Eulerian Model** in which a Rotta return-to-isotropy closure scheme corrected for the isotropization of production [IP model, @pope2000]

$$
\frac{d \overline{u_i u_j}}{dt} = -c_r \frac{\epsilon}{k}\left(\overline{u_i u_j}- \frac{2}{3}k\delta_{ij}\right) - c_I \left(\mathcal{P}_{ij}- \frac{2}{3} \mathit
{P} \delta_{ij}\right) - 
+c_3\left(\mathcal{D}_{ij}- \frac{2}{3} \mathit
{P} \delta_{ij}\right) -c_\mathcal{S}k\mathcal{S}_{ij} -\frac{2}{3}\epsilon\delta_{ij}
$$
:::

:::: {.columns}

::: {.column width='50%'}
::: {style="text-align:justify; font-size: 0.8em;"}
where

$$
\mathcal{S}_{ij} = \frac{1}{2}\left(\frac{\partial U_i}{\partial x_j}+ \frac{\partial U_j}{\partial x_i}\right) \\
    \mathcal{P}_{ij} = -\overline{u_iu_k}\frac{\partial U_j}{\partial x_k}-\overline{u_j u_k}\frac{\partial U_i}{\partial x_k}; \mathit
{P} = \frac{1}{2}\mathcal{P}_{ii}\\
    \mathcal{D}_{ij} = -\overline{u_iu_k}\frac{\partial U_k}{\partial x_j}-\overline{u_j u_k}\frac{\partial U_k}{\partial x_i}
$$
:::

:::

::: {.column width='50%'}
::: {style="text-align:justify; font-size: 0.8em;"}
in which $U_i = (U,V,W)$ are the mean velocity components and terms with an overbar are ensamble averaged quantities. $c_r$, $c_I$, $c_3$ and $c_\mathcal{S}$ are numerical constant whose values were derived by calibration with experiments

|      |      |      |      |
|:----:|:----:|:----:|:----:|
| c~r~ | c~I~ | c~3~ | c~S~ |
| 1.8  | 0.6  |  0   |  0   |

: **Model Constants**

:::
:::

::::

:::



## Lagrangian Stochastic model {.unlisted .smaller auto-animate="true"}


::: {style="text-align:justify; font-size: 0.8em;"}
The general form of the **Lagrangian Stochastic Model**
$$
du_i = -\frac{c_r \epsilon}{2 k} u_i dt + (c_I-1)u_k\frac{\partial U_i}{\partial x_k} dt + c_3 u_k\frac{\partial U_k}{\partial x_i} dt  + \sqrt{C_o \epsilon}d \mathcal{W}_i
$$
where $u_i$ are the turbulent fluctuations of the velocity vector, $k$ is the turbulent kinetic energy (TKE), $d \mathcal{W}_i$ are the increment of independent Wiener processes, $\epsilon$ is the dissipation of the tke and $C_o$ is the Kolmogorov constant for the second order velocity structure function. 

:::


### Additional Assumptions {.fragment}

::: {style="text-align:justify; font-size: 0.8em;"}
- $V, \overline{vâ€²wâ€²} = 0$
- $U, W \neq 0$ 
- $U = U (z)$ and $W = W (x)$
:::


## Lagrangian Stochastic model {.unlisted .smaller auto-animate="true"}

::: {style="text-align:justify; font-size: 0.8em;"}
**Eulerian Model**

$$
 \frac{d \overline{u^2}}{dt} = -c_r \frac{\epsilon}{k}\left(\overline{u^2}- \frac{2}{3}k\delta_{ij}\right) - \left(\frac{4}{3}c_I-2\right)\overline{uw}\frac{dU}{dz}-\frac{2}{3}c_I\overline{uw}\frac{dW}{dx}-\frac{2}{3}\epsilon\\
\frac{d \overline{v^2}}{dt} = -c_r \frac{\epsilon}{k}\left(\overline{v^2}- \frac{2}{3}k\delta_{ij}\right) -\frac{2}{3}c_I\overline{uw}\frac{dU}{dz}-\frac{2}{3}\epsilon\\
 \frac{d \overline{w^2}}{dt} = -c_r \frac{\epsilon}{k}\left(\overline{w^2}- \frac{2}{3}k\delta_{ij}\right) - \left(\frac{4}{3}c_I-2\right)\overline{uw}\frac{dW}{dx}-\frac{2}{3}c_I\overline{uw}\frac{dU}{dz}-\frac{2}{3}\epsilon
$$
:::


::: {style="text-align:justify; font-size: 0.8em;"}
**Lagrangian Stochastic Model**

$$
du = -\frac{c_r \epsilon}{2 k} u dt + (c_I-1)w\frac{d U}{d z} dt + \sqrt{C_o \epsilon}d \mathcal{W}_u\\
dv = -\frac{c_r \epsilon}{2 k} v dt  + \sqrt{C_o \epsilon}d \mathcal{W}_v\\
dw = -\frac{c_r \epsilon}{2 k} w dt + (c_I-1)u\frac{d W}{d x} dt + \sqrt{C_o \epsilon}d \mathcal{W}_w
$$
:::










## Lagrangian Stochastic model {.unlisted .smaller auto-animate="true"}

::: {style="text-align:justify; font-size: 0.8em;"}

In order for the second order closure model (SCM) and the LSM to be consistent, the constant $C_o$ must satisfy the following condition

$$C_o = \frac{2}{3}  \left[c_r -1  -c_I \frac{\overline{uw}}{\epsilon}\left(\frac{dU}{dz}+ \frac{dW}{dx}\right) \right]
$$
:::

## Lagrangian ACF and CCF

::: {style="text-align:justify; font-size: 0.6em;"}
- $dw = -\frac{c_r \epsilon}{2 k} w dt + (c_I-1)u\frac{d W}{d x} dt + \sqrt{C_o \epsilon}d \mathcal{W}_w$
- Multiply for $w(t-\tau)$ and then average:
- $\overline{w(t-\tau)~dw} = \frac{c_r \epsilon}{2 k} \bar{w(t) ~ w(t-\tau)} dt + (c_I-1) \frac{\partial W}{\partial x} \overline{u(t) ~ w(t-\tau)} dt + \sqrt{C_o \epsilon}d \overline{\mathcal{W}_w ~ w(t-\tau)}$
- For the properties of the Wiener processes $\overline{\mathcal{W}_w ~ w(t-\tau)}=0$.
:::

:::: {.columns}

::: {.column width='40%'}
::: {.fragment style="text-align:justify; font-size: 0.6em;"}

$T_{L}  =\frac{2~k}{c_r ~ \epsilon}\\ R^{(L)}_{ww}(\tau)=\frac{\overline{w(t) ~ w(t-\tau)}}{\sigma^2_w}\\R^{(L)}_{uw}(\tau)=\frac{\overline{u(t) ~ w(t-\tau)}}{\sigma^2_w}$

:::
:::

::: {.column width='60%'}
::: {.fragment style="text-align:justify; font-size: 0.8em;"}
$\frac{d}{dt}R^{(L)}_{ww} = -\frac{1}{T_L}R^{(L)}_{ww}+(c_I-1)\frac{\partial W}{\partial x}R^{(L)}_{uw}\\ \frac{d}{dt}R^{(L)}_{uw} = -\frac{1}{T_L}R^{(L)}_{uw}+(c_I-1)\frac{\partial U}{\partial z}R^{(L)}_{ww}$
:::
:::

::::


## Lagrangian ACF and CCF {.unlisted .smaller auto-animate="true"}



::: columns
::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$$\frac{d}{dt}R^{(L)}_{ww} = -\frac{1}{T_L}R^{(L)}_{ww}+(c_I-1)\frac{\partial W}{\partial x}R^{(L)}_{uw}$$

:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$$\frac{d}{dt}R^{(L)}_{uw} = -\frac{1}{T_L}R^{(L)}_{uw}+(c_I-1)\frac{\partial U}{\partial z}R^{(L)}_{ww}$$
:::
:::
:::


## Lagrangian ACF and CCF {.unlisted .smaller auto-animate="true"}

::: columns
::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$$\frac{d}{dt}R^{(L)}_{ww} = -\frac{1}{T_L}R^{(L)}_{ww}+(c_I-1)\frac{\partial W}{\partial x}R^{(L)}_{uw}$$ 
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$$\frac{d}{dt}R^{(L)}_{uw} = -\frac{1}{T_L}R^{(L)}_{uw}+(c_I-1)\frac{\partial U}{\partial z}R^{(L)}_{ww}$$
:::
:::

:::

::: {style="text-align:justify; font-size: 0.8em;"}
Using Laplace transforms and tedious simplification, the solutions of the above systems are:
:::

::: columns

::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}

$$R^{(L)}_{ww}(t) = e^{-p ~ t}\left(cos(q~t) + \frac{b}{q} ~ sin(q~t)   \right)$$

:::
:::

::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$$R^{(L)}_{uw}(t) = e^{-p ~ t}\left(R^{(L)}_{uw}(0) ~ cos(q~t) + \frac{c'}{q} sin(q~t)   \right)$$
:::
:::

:::




## Lagrangian ACF and CCF {.unlisted .smaller auto-animate="true"}

::: columns
::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$$\frac{d}{dt}R^{(L)}_{ww} = -\frac{1}{T_L}R^{(L)}_{ww}+(c_I-1)\frac{\partial W}{\partial x}R^{(L)}_{uw}$$ 
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$$\frac{d}{dt}R^{(L)}_{uw} = -\frac{1}{T_L}R^{(L)}_{uw}+(c_I-1)\frac{\partial U}{\partial z}R^{(L)}_{ww}$$
:::
:::

:::


::: {style="text-align:justify; font-size: 0.8em;"}
Using Laplace transforms and tedious simplification, the solutions of the above systems are:
:::

::: columns

::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}

$$R^{(L)}_{ww}(t) = e^{-p ~ t}\left(cos(q~t) + \frac{b}{q} ~ sin(q~t)   \right)$$

:::
:::

::: {.column width="50%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$$C_{uw}^{(L)}(t) = e^{-p t}\left(\frac{\overline{u'w'}}{\sigma_u \sigma_w}cos(q t)+\frac{c}{q}sin(q t)\right)$$
:::
:::

:::

::: {style="text-align:justify; font-size: 0.8em;"}
Parameters of above Eqs. are related to the properties of the turbulent flow by the following relationship:


:::: {.columns}

::: {.column width='50%'}
$$T_L = p^{-1} = \frac{2~k}{c_I ~ \epsilon}\\ R^{(L)}_{uw}(0) = \frac{\overline{uw}}{\sigma^2_w}\\ b = (c_I-1)R^{(L)}_{uw}(0)\frac{d W}{d x}\\ $$
:::

::: {.column width='50%'}
$$c = (c_I-1)\frac{\sigma_w}{\sigma_u}\frac{d U}{d z}\\ q = \sqrt{-\frac{1}{T^2_L}-(c_I-1)^2~\frac{d U}{d z}\frac{d W}{d x}}$$
:::

::::



:::

## Lagrangian ACF and CCF {.unlisted .smaller auto-animate="true"}

::: {style="text-align:justify; font-size: 0.8em;"}

:::: {.columns}

::: {.column width='50%'}
$$T_L = p^{-1} = \frac{2~k}{c_I ~ \epsilon}\\ R^{(L)}_{uw}(0) = \frac{\overline{uw}}{\sigma^2_w}\\ b = (c_I-1)R^{(L)}_{uw}(0)\frac{d W}{d x}\\ $$
:::

::: {.column width='50%'}
$$c = (c_I-1)\frac{\sigma_w}{\sigma_u}\frac{d U}{d z}\\ q = \sqrt{-\frac{1}{T^2_L}-(c_I-1)^2~\frac{d U}{d z}\frac{d W}{d x}}$$
:::

::::

:::

::: {style="text-align:center; font-size: 0.8em;"}
**ACF and CCF employed in the article**
:::

::: columns
::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$R_{w}(\tau) = e^{-p_{w} \tau}cos(q_{w} \tau)$
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$C_{uw}(\tau) = e^{-p_{uw}\tau}\left(\frac{\overline{u'w'}}{\sigma_u \sigma_w}cos(q_{uw} \tau)+\frac{c}{q}sin(q_{uw} \tau)\right)$
:::
:::
:::

::: {style="text-align:center; font-size: 0.8em;"}
**Lagrangian ACF and CCF**
:::

::: columns
::: {.column width="70%" style="text-align: center;"}
::: {style="text-align:center; font-size: 0.8em;"}
$R_{w}^{(L)}(t) = e^{-p t}cos(q t) + \color{red}{\frac{b}{q}sin(q t)}$
:::
:::

::: {.column width="50%"}
::: {style="text-align:justify; font-size: 0.8em;"}
$C_{uw}^{(L)}(t) = e^{-p t}\left(\frac{\overline{u'w'}}{\sigma_u \sigma_w}cos(q t)+\frac{c}{q}sin(q t)\right)$
:::
:::
:::

# Conclusions {auto-animate="true"}

## Conclusions {.smaller .unlisted auto-animate="true"}
::: {style="text-align:justify; font-size: 0.8em;"}

- The detection of coherence structures and their characteristic timescales were accomplished by fitting the vertical velocity auto-correlation functions with an oscillating decaying function.

- The proposed methodology represents a new and alternative instrument for assessing the presence and influence of coherent structures in the atmospheric
flow at the canopy-forest interface.

- The value of the $m$ parameter (that represents the ratio between the time scale of fine-scale turbulence oscillations and the time scale of oscillations) was used to discriminate between data subset were coherent structures were absent ($m=NA$) from data subset in which the flow was characterized by them ($m>1$).

- The contribution to momentum and heat fluxes of both coherent structures and fine scale turbulence increases with increasing time cover.

- The maximum flux contributions are attained in neutral conditions or in moderately stable and unstable regimes and do not exceed 40%.

- Finally, simplified bi-dimensional Lagrangian stochastic equations derived from a second order closure model were used to explain the ACF and CCF oscillations. The model showed how the appearance of such oscillation and hence of coherent vortices in the x âˆ’ z plane depends on the transverse vorticity component.

:::

# Obrigrado <lord-icon src="https://cdn.lordicon.com/xxdqfhbi.json" trigger="loop" style="width:250px;height:250px"> {.unlisted}

## References {.scrollable .smaller}

::: {#refs style="text-align:justify; font-size: 0.8em;"}
:::
